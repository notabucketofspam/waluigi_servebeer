<!DOCTYPE html>
<html>
<head>
<title>[outdex steakzone] - waluigi-servebeer.com</title>
<link rel="stylesheet" type="text/css" href="/css/great-scott.css">
<meta name="viewport" content="width=device-width, user-scalable=yes" />
<style>
.getitouttahere {
  display: none;
}
#label-for-cowbox {
  font-style: italic;
  cursor:
}
#cowbox {
  height: 10px;
  accent-color:red;
}
#hoverboots {
  left: 60px;
  position: fixed;
  top: 0px;
  z-index: 11;
}
</style>
</head>
<body>
  <div id="hoverboots">
    <span>only the highest-quality meats are selected for serving on waluigi-servebeer.com</span>
    <br />
    <button id="quit" hidden>quit</button>
    <input id="cowbox" type="checkbox" /><label id="label-for-cowbox" for="cowbox">show cowtools?</label>
    <span id="cowtools" class="getitouttahere">
      <button id="button" title="did you bring a big enough plate for dinner, son?">plate</button>
      <button id="ick" title="wolfjerkeytm">wolfjerkey&#8482;</button>
      <button id="meateater" title="plagiarism, grand theft, and fraud">prime cuts</button>
      <button id="eatmeter" title="random colors" hidden>eatmeter</button>
      <input id="meeptheater" type="url" hidden placeholder="meeptheater" title="where do you wanna go?" />
      <button id="meeper" title="you wanna go *there*? for real?" hidden>meeper</button>
    </span>
  </div>
<main></main>
<script src="/js/everything.js"></script>
<script src="/js/party-og.js"></script>
<script>
  var startup_done = true;
  consume(hashgrab());
var main = document.querySelector('main');
var button = document.getElementById("button");
  var ick = document.getElementById("ick");
  var meateater = document.getElementById("meateater");
  var eatmeter = document.getElementById("eatmeter");
  var meeper = document.getElementById("meeper");
/**@type HTMLInputElement*/
var meeptheater = document.getElementById("meeptheater");
var quit = document.getElementById("quit");
  var bread = 
/(?:(?<=\<title\>)(?<title>.*?)(?=\<\/title\>))|(?:(?<=\<style\>)(?<glitter>.*?)(?=\<\/style\>))|(?<lonk>\<link.*?\>)|(?:(?<=\<script\>)(?<soup>.*?)(?=\<\/script\>))|(?:(?<=\<script src=")(?<scrsrc>.*?)(?="\>\<\/script\>))/gs;
  /**@type HTMLInputElement*/
  var cowbox = document.getElementById('cowbox');
  var cowtools = document.getElementById('cowtools');
  var labelForCowbox = document.getElementById('label-for-cowbox');
  /**
   * put those almonds to good use
   * @param {string} url the page you need
   */
function consume(url) {
  if (url.includes("outdex.html")) {
    console.log(url);
    quit_more();
    return;
  }
  var burgmenu = document.getElementById("burgmenu");
  burgmenu.hidePopover();
  //cog(burgmenu);
  var bmp = document.getElementById("burgmenu_mp");
  var party_zone = document.getElementById("party_zone");
  if (party_zone) {
    burgmenu.insertBefore(party_zone, bmp);
  }
  unprepare_almonds();
  fetch(url)
    .then(res => res.text())
    .then(restext => {
      main.replaceChildren();
      var newtext = restext.replaceAll(bread, function replacer(substring, ...args) {
          const groups = args.at(-1);
        if (typeof groups === 'object') {
          //cog(groups)
          if (groups.glitter) {
            const style = document.createElement('style');
            style.innerHTML = groups.glitter;
            main.prepend(style);
          }
          if (groups.soup) {
            setTimeout(() => {
              const script = document.createElement('script');
              script.innerHTML = groups.soup;
              main.prepend(script);
            }, 0);
          }
          if (groups.scrsrc && groups.scrsrc !== "/js/everything.js" && groups.scrsrc !== "/js/party-og.js") {
            setTimeout(()=> {
              const script = document.createElement('script');
              script.src = groups.scrsrc;
              main.prepend(script);
            }, 0);
          }
          if (groups.title) {
            document.title = groups.title;
          }
          if (groups.lonk) {
          }
        }
        return "";
      });
      main.insertAdjacentHTML('beforeend', newtext);
      prepare_almonds();
      return_steak.hidden = !!document.getElementById('welcome_steak');
      scroll(0,0);
    }
  );
}
/**greedy lil thief*/
function hashgrab() {
 return location.hash.substring(1)||"/";
}
function show_cowtools() {
  cowtools.classList.toggle('getitouttahere');
  return labelForCowbox.classList.toggle('getitouttahere')|0;
}
cowbox.addEventListener('change', ev => {
  localStorage.setItem("show_cowtools", show_cowtools());
});
if (localStorage.getItem("show_cowtools")|0) {
  show_cowtools();
  cowbox.checked = true;
}
button.addEventListener("click", how_big);
function how_big() {
  var bwidth = document.body.getBoundingClientRect().width;
  var bheight = document.body.getBoundingClientRect().height;
  var how_wide = innerWidth/devicePixelRatio/96;
  var how_tall = innerHeight/devicePixelRatio/96;
  var snide_comment = (how_wide<3||how_tall<3)?"that's a *small* plate you got there, bud!":
    (how_wide>18||how_tall>18)?"that's a *huge* plate you got there, my dude!":
    "that's an ok size for a plate.";
  alert("your dinner plate is "+how_wide.toFixed(2)+'" wide and '+how_tall.toFixed(2)+'" tall. '+snide_comment);
}
var kasa;
async function stupid_meateater(ev) {
  if (typeof kasa === 'undefined') {
    await import('/page/meat-substrate/words.js');
    kasa = __WORDS.replace(/\u{2019}/gu,"'").split("|");
  }
  var noodles = document.createNodeIterator(main, 4);
  var curry;
  var c = 0;
  while(curry = noodles.nextNode()) {
    if (curry.textContent.trim()&&!curry.textContent.includes("}")) {
      var jerry = curry.textContent.replace(/'/g,"").replace(/\b\w+?\b/g,
      function(emu) {
        var show;
        var ne = 0;
        do {
          show = kasa.at(rui(kasa.length));
        } while (Math.abs(show.length-emu.length)>1 && ne++<99);
        return show;
      });
      curry.textContent = jerry;
    }
    if(c++ > 2011) break; // hehe
  }
}
meateater.addEventListener("click", stupid_meateater);

var wolfjerkeytm = "<u>Meat #3: Wolf Jerkey&#8482;</u> I think that Wolf Jerkey&#8482; is pretty good. And I'm not just saying that. What makes Wolf Jerkey&#8482; special is the ingredients. Wolf Jerkey&#8482; is made with 100% Real Wolf Meat&#8482; and 100% Real Honey&#8482;. That's what makes Wolf Jerkey&#8482; special. Preorders available now.";
ick.title= wolfjerkeytm;
function become_wolfjerkeytm(ev){
  document.body.style.backgroundColor="#feefee";
  var noodles = document.createNodeIterator(main, 4);
  var curry;
  var c = 0;
  while(curry = noodles.nextNode()) {
    if (curry.textContent.trim()&&!curry.textContent.includes("}")) {
      const dic = document.createElement("span");
      dic.style = "font-family: monospace";
      dic.innerHTML = wolfjerkeytm;
      curry.parentNode.replaceChild(dic, curry);
      curry = noodles.nextNode();
      curry = noodles.nextNode();
    }
    if(c++ > 2020) break; // hehehe
  }
};
ick.addEventListener('click', become_wolfjerkeytm);

  function unprepare_almonds() {
    const allah = document.querySelectorAll("a");
    for (const a of allah) {
      a.removeEventListener('click', dubiousLink);
    }
  }
  function prepare_almonds() {
    const allah = document.querySelectorAll("a");
    for (const a of allah) {
      if (!a.href||a.classList.contains("no-almonds")) {
      } else if (a.pathname.includes("outdex.html") || a.classList.contains("dropdown_item")) {
        a.href = hashgrab();
      } else {
        a.addEventListener('click', dubiousLink);
      }
    }
  }
  /**@param {MouseEvent}ev*/
  function dubiousLink(ev) {
    ev.preventDefault();
  /**@type HTMLAnchorElement*/
    const a = ev.composedPath().find(el => el instanceof HTMLAnchorElement);
    const pn = a.pathname;
    location.hash = pn;
    consume(pn);
  }
  var fun_colours_tracker;
  var fun_colours_going;
  var fun_holder = 0;
  eatmeter.addEventListener('click', ev => {
      if (fun_colours_going) {
        clearInterval(fun_colours_tracker);
        document.body.style.transition = "";
        document.body.style.backgroundColor = "";
        fun_colours_going = false;
      } else {
        document.body.style.transition = "background-color 16ms";
        fun_colours_tracker = setInterval(fun_colours, 16);
        fun_colours_going = true;
      }
  });
  function fun_colours() {
    document.body.style.backgroundColor =
    `oklch(0.77 0.34 ${fun_holder+=(7e-3)}turn)`;
  }

  function donatehash() {
    let valproate = meeptheater.value;
    if (valproate) {
      location.hash = valproate;
      consume(valproate);
    }
  }
  meeper.addEventListener('click', donatehash);
  
  quit.addEventListener("click", ev => quit_more());
  function quit_more() {
    alert("The door is closed.");
    //prompt("Headin' back to Sydney, bruv?", "S\xED");
    location.assign("/");
    return;
  }
</script>
</body>
</html>
